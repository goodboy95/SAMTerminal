spring:
  datasource:
    url: ${DB_URL:jdbc:mysql://localhost:3306/sam?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=UTC}
    username: ${DB_USERNAME:root}
    password: ${DB_PASSWORD:123456}
  jpa:
    hibernate:
      ddl-auto: update
    properties:
      hibernate:
        format_sql: true
    show-sql: false
  jackson:
    serialization:
      write-dates-as-timestamps: false
  sql:
    init:
      mode: never
server:
  port: ${PORT:8080}

security:
  jwt:
    secret: ${JWT_SECRET:devsecretkeysamterminal1234567890abcd}
    expiration: 86400000

cors:
  allowed-origins: ${CORS_ORIGINS:http://samproject.seekerhut.com,http://localhost:5173,http://localhost:4173}

app:
  upload-dir: ${UPLOAD_DIR:uploads}
  trusted-proxies: ${TRUSTED_PROXIES:127.0.0.1,::1}
  # 后台(/admin)管理员账号：支持配置多个，启动时会自动同步到数据库并赋予 ADMIN 角色。
  # 注意：此处为示例默认值，生产环境建议通过私有配置文件或环境变量覆盖。
  admins:
    - username: admin
      password: AdminPass123456
      email: admin@sam.local
    - username: operator
      password: OperatorPass123456
      email: operator@sam.local
  llm:
    min-remaining-tokens: ${APP_LLM_MIN_REMAINING_TOKENS:2000}
    min-remaining-percent: ${APP_LLM_MIN_REMAINING_PERCENT:5}
    session-timeout-minutes: ${APP_LLM_SESSION_TIMEOUT_MINUTES:30}
    request-timeout-seconds: ${APP_LLM_REQUEST_TIMEOUT_SECONDS:20}
    circuit-breaker:
      failure-threshold: ${APP_LLM_FAILURE_THRESHOLD:3}
      probe-interval-minutes: ${APP_LLM_PROBE_INTERVAL_MINUTES:10}

chroma:
  url: ${CHROMA_URL:http://localhost:8000}

email:
  code-ttl: 5m
  resend-interval: 1m
  max-verify-attempts: 5
  auto-ban-threshold: 50
  auto-ban-extra: 5m
  rate-limit:
    challenge-per-minute: 30
    verify-per-minute: 30
    send-per-minute: 10
    verify-code-per-minute: 30
  cap:
    base-url: ${CAP_BASE_URL:}
    site-key: ${CAP_SITE_KEY:}
    site-secret: ${CAP_SITE_SECRET:}
    test-mode: ${CAP_TEST_MODE:false}
    request-timeout-seconds: 5
  domain-policy:
    allowlist: ${EMAIL_DOMAIN_ALLOWLIST:}
    denylist: ${EMAIL_DOMAIN_DENYLIST:}
    disposable-list-path: ${EMAIL_DISPOSABLE_LIST_PATH:classpath:disposable-email-domains.txt}
    enabled: ${EMAIL_DOMAIN_POLICY_ENABLED:true}
  smtp:
    failure-threshold: 3
    circuit-open-minutes: 10
    connect-timeout-seconds: 5
    read-timeout-seconds: 10
    max-attempts: 3
  send-task:
    batch-size: 10
    max-attempts: 3
    initial-backoff-seconds: 10
    max-backoff-seconds: 300
    worker-delay-seconds: 2
  encryption:
    key-base64: ${EMAIL_LOG_CODE_ENC_KEY_BASE64:}
    code-hash-salt: ${EMAIL_CODE_HASH_SALT:}
